/*! amoStorage 0.3.0 | Copyright (c) 2014 Author: amo | License: MIT */(function(){"use strict";var a;a={},a.isEmptyObj=function(a){var b;for(b in a)return!1;return!0},angular.module("amo.webStorage",[]).provider("amoStorageManager",function(){var a;return a={appName:"amoStorage",revision:"1.0.0",separator:"/",keyGeneratorFactory:function(a,b,c,d){var e;return e=[a,b,d].join(c),function(a){return[e,a].join(c)}},ruleForDeletingRevisions:function(){return!0},$get:function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o;return d=a.appName,j=a.revision,m=a.separator,g=a.keyGeneratorFactory,l=a.ruleForDeletingRevisions,n="#",o="$",f=function(a){return""+d+"/"+a+"/keys"+o},h=f(j),k=""+d+"/revisions"+o,e=function(a,b){var c,d,e,g,h;g=f(b),e=angular.fromJson(a.getItem(g));for(h in e){d=e[h];for(c in d)a.removeItem(c)}return a.removeItem(g)},i=function(a){var b,c,d,f,g;for(null==a&&(a=localStorage),d=angular.fromJson(a.getItem(k)||"[]"),b=[j],f=0,g=d.length;g>f;f++)c=d[f],j!==c&&(l(c)?e(a,c):b.push(c));return a.setItem(k,angular.toJson(b))},b=function(a,b,c){var e,f,h,i,k;return i=g(d,j,m,b),h=function(a){return""+i(a)+n},f={EXPIRED_TIME:"e",CREATE_DATETIME:"c",LAST_USAGE_DATETIME:"u"},k=function(b,d){var e;return c.get(b)?(e=angular.fromJson(a.getItem(b)),e?d-e.config[f.LAST_USAGE_DATETIME]>1e3*e.config[f.EXPIRED_TIME]?(a.removeItem(b),c.del(b),null):e:null):null},e={confKey:f,get:function(a,b,c){var d;return null==b&&(b=null),null==c&&(c=(new Date).getTime()),a=h(a),d=k(a,c),d?d.value:b},use:function(b,c,d){var e;return null==c&&(c=null),null==d&&(d=(new Date).getTime()),b=h(b),(e=k(b,d))?(e.config[f.LAST_USAGE_DATETIME]=d,a.setItem(b,angular.toJson(e)),e.value):c},set:function(b,d,e,g){var i,j,k;return null==g&&(g=(new Date).getTime()),b=h(b),i=angular.fromJson(a.getItem(b)),i&&i.config&&i.value||(i={config:{}}),i.value=d,e&&(i.config[f.EXPIRED_TIME]=e),null==(j=i.config)[k=f.CREATE_DATETIME]&&(j[k]=g),i.config[f.LAST_USAGE_DATETIME]=g,a.setItem(b,angular.toJson(i)),c.set(b),this},del:function(b){var d;return d=this.get(b),b=h(b),a.removeItem(b),c.del(b),d},delAll:function(){return c.delAll()}}},c=function(a){var c,d,e;return i(a),e={},d=angular.fromJson(a.getItem(h)||"{}"),c=function(b){var c,e;return e=null!=d[b]?d[b]:d[b]={},c={get:function(a){return e[a]||!1},set:function(b){return e[b]=!0,a.setItem(h,angular.toJson(d)),c},del:function(b){return delete e[b],a.setItem(h,angular.toJson(d))},delAll:function(){var b;for(b in e)a.removeItem(b),delete e[b];return a.setItem(h,angular.toJson(d))}}},function(d){return null!=e[d]?e[d]:e[d]=b(a,d,c(d))}},{getLocalStorage:c(localStorage),getSessionStorage:c(sessionStorage)}}}})}).call(this);